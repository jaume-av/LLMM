---

title:  XML: Definició, estructura i regles bàsiques
parent: 1.- XML i DTD
grand\_parent: Llenguatges de Marques
has\_children: true
layout: default
nav\_order: 10
--------------

# 1.- Què és XML?

XML, *Extensible Markup Language*, és un llenguatge de marques utilitzat per **emmagatzemar i intercanviar dades estructurades** de manera llegible tant per humans com per màquines.

### Principals característiques d’XML

* **És un llenguatge de marques**: utilitza etiquetes per definir i estructurar les dades. Les etiquetes descriuen què representen les dades. Per exemple, `<persona>` pot envoltar les dades d’una persona.
* **És extensible**: podem definir **les nostres pròpies etiquetes** i estructures. Açò dóna flexibilitat per a formats específics.
* **És jeràrquic**: segueix una estructura en **arbre**; unes etiquetes poden contindre altres etiquetes per representar relacions.
* **Llegible per humans**: el format és clar i editable manualment.
* **Interoperable**: és un **estàndard àmpliament acceptat**; moltes aplicacions el comprenen i facilita l’intercanvi de dades entre sistemes.
* **Usos variats**: processament de textos, bases de dades, representació de documents (p. ex. XHTML), serveis web, fitxers de configuració de programari, etc.
* **Compatibilitat amb Unicode**: pot emmagatzemar text en diverses codificacions; per defecte usa Unicode (UTF-8/UTF-16), permetent una àmplia gamma de caràcters.

**En resum**, XML és un llenguatge de marques **versàtil i estandarditzat** per representar i intercanviar dades estructurades de manera clara i flexible en moltes aplicacions informàtiques.

### XML NO és

* No és un llenguatge de programació.
* No és un protocol de xarxa.
* No és una base de dades.

### Ecosistema i tecnologies relacionades

* **XPath** i **XQuery**: llenguatges per **seleccionar i consultar** dades dins de documents XML (buscar, filtrar i extraure informació).
* **XPointer (XML Pointer Language)**: per **identificar parts específiques** d’un document XML.
* **XLink (XML Linking Language)**: per afegir **enllaços hipertextuals** estructurats en documents XML.
* **DTD (Document Type Definition)** i **XML Schema (XSD)**: mecanismes per **definir l’estructura i la validesa** de les dades XML.
* **XSLT (Extensible Stylesheet Language Transformations)** i **XSL-FO**: transformar documents XML a altres formats (p. ex. HTML) i per a formatar-los.

### Observacions sobre l’estructura

* Les dades d’un document XML es poden representar com a **arbres**.
* Tots els documents XML tenen **una única etiqueta arrel (root)** que no és fill de ningú.
* Les **fulles** d’un arbre poden ser **elements sense fills** o **nodes de text**. *Els atributs no són fills; no formen part de la jerarquia d’elements.*
* S’utilitza la terminologia **parent** (pare), **child** (fill) i **sibling** (germà).
* Tots els elements poden tindre **contingut textual** (`"Mad Max"`) i **atributs** (`categoria="accio"`).

### Anàlisi d’XML i validació

Objectiu: que els documents XML puguen ser llegits i **interpretats per programes**.

Els analitzadors (*parsers*):

* Comproven que es compleixen les **regles de ben formació** (*well-formedness*).
* Poden comprovar que el document és **vàlid** segons un DTD o XSD.

Operacions habituals:

1. **Correcte/Ben format**: comprovar que el document segueix **la sintaxi XML** (etiqueta arrel única, etiquetes tancades i niades, atributs entre cometes, etc.).
2. **Vàlid**: comprovar que el document compleix **l’estructura esperada** definida en un **DTD** o **XML Schema**.

### Tractament d’errors en XML

* Si el document **no és ben format**, es tracta d’un **error fatal**: el parser **ha d’aturar** el processament.
* Altres problemes (p. ex. **invalidesa** respecte a un DTD/XSD) poden ser considerats **no fatals** segons l’entorn: el document pot ser ben format però **no vàlid**.

### Analitzadors XML (parsers) habituals

* **xmllint**: forma part de la llibreria **libxml2**.
* **Apache Xerces**: projecte de la Fundació Apache (Java, C++, Perl).
* **Expat**: llibreria d’anàlisi XML en C.
* **Windows.Data.Xml**: **espai de noms (API)** del món Windows/UWP per a treballar amb XML (no és una eina de línia d’ordres).

### Editors XML

* Qualsevol editor de text (VS Code, Atom, Gedit, Kate, Notepad++), molts amb **ressaltat de sintaxi**.
* Editors amb suport XML aporten **autoemplenat**, **validació**, **creació d’esquemes** i **transformacions**.
* Editors especialitzats: **XML Copy Editor**, **Altova XMLSpy**, **oXygen XML**, **Liquid XML Studio**, **Stylus Studio**, **XMLPad**.
* Molts IDEs de programació també tenen suport: **IntelliJ**, **Eclipse**, **Microsoft Visual Studio**, **WebStorm**.

---

# 2.- XML – Regles bàsiques

Els documents XML contenen **text, etiquetes i atributs**:

```xml
<nom carrec="coordinadora">Isabel S.</nom>
```

* **Etiquetes**: `<nom>...</nom>`
* **Atributs**: `carrec="coordinadora"`
* **Text**: `Isabel S.`

> No es pressuposa res sobre la presentació; **l’usuari controla l’organització** i representació de les dades.

### Regles bàsiques

1. **Etiqueta arrel**: tots els documents tenen **una única arrel** que conté la resta.
   En l’exemple, `<persona>` seria l’arrel.
   **No seria correcte** com a document XML (perquè hi ha dos arrels):

```xml
<persona>
    <nom>Aitor Tilla</nom>
    <nom>Lola Mento</nom>
</persona>

<nom>Aitor Tilla</nom>
<nom>Lola Mento</nom>
```

> L’únic que pot estar fora de l’arrel són **comentaris** i **instruccions de procés**.

2. **Les etiquetes s’han de tancar**:

```xml
<article>Disquet</article>
```

No val el que permet (a voltes) HTML:

```xml
<!-- Incorrecte en XML -->
<article nom="disquet">
```

Si no hi ha contingut, es pot usar el **tancament buit**:

```xml
<article nom="disquet"/>
```

3. **Etiquetes correctament niades**:

```xml
<inventari>
  <article>Disquet</article>
</inventari>

<!-- Incorrecte (tancament desordenat) -->
<inventari>
  <article>
    Disquet
  </inventari>
</article>
```

4. **Noms correctes d’elements/atributs**

   * **Han de començar per una lletra o per `_`**.
   * Després poden incloure **lletres, dígits, `-`, `_`, `.`** i, eventualment, **`:`** per a **namespaces**.
   * **No** poden contindre espais.
   * **No** poden començar per la paraula `xml` (en qualsevol combinació de majúscules/minúscules).
   * El **`:`** està reservat per a **namespaces**; evita usar-lo si no treballes amb namespaces.

**Correctes / Incorrectes**

| Correctes                 | Incorrectes                                                 |
| ------------------------- | ----------------------------------------------------------- |
| `<Ciutat></Ciutat>`       | `<XmlElement></XmlElement>` *(comença per “Xml” —evita-ho)* |
| `<Item12></Item12>`       | `<1Osset></1Osset>`                                         |
| `<casa-Nova></casa-Nova>` | `< Item></ Item>`                                           |
| `<element></element>`     | `<Aitor Tilla></Aitor Tilla>`                               |
| `<_Hola></_Hola>`         | `<$Diners></$Diners>`                                       |

5. **Distinció de majúscules/minúscules (case-sensitive)**

```xml
<Article>Disquet</Article>
<article>Disquet</article>  <!-- Són etiquetes diferents -->
```

**Incorrecte**:

```xml
<Article>Disquet</article>
```

6. **Valors entre cometes**
   Els valors dels atributs han d’estar **entre cometes** (simples o dobles) i **sempre han de tindre un valor**:

```xml
<Article quantitat="3">Disquet</Article>
```

**Incorrecte**:

```xml
<Article quantitat=3>Disquet</Article>
<Article quantitat>Disquet</Article>
```

---

# 3.- XML – Creació de documents

### Declaració XML

Línia especial al principi del document que indica **versió** i **codificació** (i opcionalment **standalone**):

```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
```

* **Opcional però recomanable**.
* Normalment inclou `version` i `encoding`. `standalone` s’usa quan el document **depén** (o no) d’entitats externes (p. ex. DTD).

**Atributs:**

* `version`: habitualment **"1.0"**. La "1.1" aporta canvis menors.
* `encoding`: defineix la **codificació**. Per defecte, XML usa **Unicode** (UTF-8 o UTF-16), però es poden usar altres codificacions quan cal.

  * **UTF-8**: molt utilitzada; eficient i capaç de representar tota la gamma Unicode.
  * **UTF-16**: usa unitats de 16 bits; pot requerir **parelles de substitució (surrogates)** per a caràcters fora del BMP (per tant, no és “sempre 2 bytes” efectius per caràcter).
  * **ISO-8859-1/2/15**, **Windows-1252**, etc.: codificacions específiques d’idiomes/entorns.
* `standalone`:

  * `"yes"`: el document és **independent** (no requereix entitats/DTD externes).
  * `"no"`: el document **depén** d’alguna definició externa (p. ex. DTD).

**Nota:** `version`, `encoding` i `standalone` **només apareixen en la declaració** `<?xml ...?>`. **No existeixen** com a atributs `xml:version`, `xml:encoding` ni `xml:standalone` dins d’elements.

### Etiquetes i atributs

* Les etiquetes van entre `<` i `>`.
* Han de ser **autoexplicatives**.
* Un element pot tindre **tants atributs com calga**.

**Exemple:**

```xml
<poble>La Vall d'Uixó</poble>
```

**Atributs (conceptes clau)**

* Parell **clau=valor**, amb el valor **entre cometes**.
* El **nom** ha de ser **vàlid** (regles anteriors) i **no repetit** dins del mateix element.
* **Tots els atributs han de tindre valor**:

```xml
<nom carrec="">   <!-- CORRECTE -->
<nom carrec>      <!-- INCORRECTE -->
```

**Exemple amb diversos atributs:**

```xml
<persona nom="Lola" cognom="Mento" edat="30"/>
```

* **Metadades**: informació addicional (p. ex. nom, cognom, edat).
* **Control del contingut**: p. ex. un atribut `href` en `<enllac>` podria indicar una URL.
* **Idioma**: p. ex. `xml:lang`.
* **Estil** (en XHTML/HTML): atributs com `style` o `class` afecten la presentació.

**Exemple:**

```xml
<cotxe marca="Toyota" model="Camry" any="2023"/>
```

### Atributs predefinits i espais de noms

* **xmlns**: defineix l’**espai de noms (namespace)** d’un element o conjunt d’elements.
* **xmlns\:xsi**: defineix l’espai de noms **XML Schema Instance**.
* **xsi\:schemaLocation**: indica la ubicació de l’**esquema XSD** per validar.
* **xml\:lang**: idioma del contingut.
* **xml\:id**: **identificador únic** d’un element.
* **xml\:base**: URL base per resoldre rutes relatives.
* **xml\:space**: control de l’**espai en blanc** (valors: `default` o `preserve`).

> *Recordatori:* `xml:version`, `xml:encoding`, `xml:standalone` **no són atributs vàlids** dins d’elements.

**Exemples:**

```xml
<missatge xml:lang="ca">Hola!</missatge>
<missatge xml:lang="fr">Salut!</missatge>

<paragraf xml:space="default">
  Aquest és un exemple     amb espais en   blanc.
</paragraf>
```

* Amb `xml:space="default"`, els espais en blanc innecessaris es poden normalitzar.
* Amb `xml:space="preserve"`, **es conserven**.

### Entitats

XML permet qualsevol text Unicode, però hi ha **caràcters especials** que s’han d’escapar amb **entitats**:

* `&lt;`  → `<`
* `&gt;`  → `>`
* `&amp;` → `&`
* `&quot;` → `"`
* `&apos;` → `'`

**Exemple:**

```xml
<paragraf>El &lt;tonto&gt; del poble.</paragraf>
```

### CDATA

Secció especial per incloure text amb caràcters que d’altra manera s’interpretarien com a marques XML.

**Sintaxi:**

```xml
<![CDATA[ Text o dades que poden contindre caràcters especials ]]>
```

**Exemple:**

```xml
<descripcio>
  <![CDATA[
    <p>Aquesta és una pàgina d'exemple.</p>
    <a href="http://www.exemple.com">Visita el nostre lloc web</a>
  ]]>
</descripcio>
```

**Notes importants:**

* Dins d’un CDATA **no pot aparéixer** la seqüència `]]>`.
* Les seccions **CDATA no es poden niar**.

### Comentaris

Ignorats pels processadors XML.

```xml
<!-- Això és un comentari -->

<!--
I això també
és un comentari
-->
```

### Instruccions de procés (*Processing Instructions*, PI)

Permeten que programes externs facen tasques específiques.

**Sintaxi general:**

```xml
<?nom_del_processador funcio(valor)?>
```

**Exemple:**

```xml
<?calculadora suma(5, 7)?>
```

**Associar un CSS a un XML:**

```xml
<?xml-stylesheet type="text/css" href="estilo-animales.css"?>
```

**Fitxers d’exemple**

**“estilo-animales.css”**

```
nombre{color:blue;font-size:40px}
patas{color:red;font-size:22px}
```

**“animales.xml”**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/css" href="estilo-animales.css"?>

<animales>
  <animal>
    <nombre>perro</nombre>
    <patas>4</patas>
  </animal>
  <animal>
    <nombre>pato</nombre>
    <patas>2</patas>
  </animal>
  <animal>
    <nombre>ballena</nombre>
    <patas>0</patas>
  </animal>
</animales>
```

En un navegador compatible es veuria aplicant els estils.

---

# 4.- Espais de noms (Namespaces)

Com que qualsevol pot crear etiquetes amb qualsevol nom, en combinar documents poden aparéixer **col·lisions de noms**. Els **espais de noms** garantixen que **els noms siguen únics** i eviten conflictes.

Es declaren amb l’atribut **`xmlns`** (URI/URL) en els elements.

**Sintaxi bàsica (espai de noms per defecte):**

```xml
<element_arrel xmlns="http://www.example.com/espai_de_noms">
  <!-- Elements i atributs dins d'aquest espai de noms -->
</element_arrel>
```

**Amb prefixos (per usar diversos espais):**

```xml
<element_arrel xmlns:prefix="http://www.example.com/espai_de_noms">
  <prefix:element>Contingut</prefix:element>
</element_arrel>
```

**Exemple amb prefixos:**

```xml
<alumnes:nom xmlns:alumnes="http://server/alumnes">Aitor Tilla</alumnes:nom>
<professors:nom xmlns:professors="http://server/professors">Lola Mento</professors:nom>
```

**Carrega dels espais de noms abans de les dades**:

```xml
<?xml version="1.0"?>
<classe xmlns:A="http://server/alumnes"
        xmlns:P="http://server/professors">
  <A:nom>Aitor Tilla</A:nom>
  <P:nom>Lola Mento</P:nom>
</classe>
```

**Definir un espai de noms per defecte i un amb prefix:**

```xml
<?xml version="1.0"?>
<classe xmlns="http://server/alumnes"
        xmlns:P="http://server/professors">
  <nom>Aitor Tilla</nom>
  <P:nom>Lola Mento</P:nom>
</classe>
```

**Redefinir l’espai de noms en un descendent:**

```xml
<?xml version="1.0"?>
<classe xmlns="http://server/alumnes">
  <nom>Aitor Tilla</nom>
  <nom xmlns="http://server/professors">Lola Mento</nom>
</classe>
```

**En resum**, amb espais de noms podem **integrar etiquetes de diferents llenguatges** dins d’un document XML (SVG, XHTML, SMIL, ...).

**Nom / URL d’espais de noms coneguts**

* **XML**: `http://www.w3.org/XML/1998/namespace`
* **XSLT**: `http://www.w3.org/1999/XSL/Transform`
* **XSL-FO**: `http://www.w3.org/1999/XSL/Format`
* **XHTML**: `http://www.w3.org/1999/xhtml`
* **SVG**: `http://www.w3.org/2000/svg`

> *Correcció important*: l’URI d’SVG correcte és `http://www.w3.org/2000/svg` (no la URL del document “TR”).

---

## Annex: Mini-checklist de qualitat

* Hi ha **una única arrel**?
* **Totes** les etiquetes **tanquen** i estan **niades** correctament?
* **Atributs entre cometes** i amb **valor**?
* Entitats usades on cal (`<`, `>`, `&`, `"` i `'`)?
* **No** hi ha atributs inventats `xml:*` (recorda: `xml:version`/`xml:encoding`/`xml:standalone` **no existeixen** dins d’elements)?
* **Namespaces** declarats abans d’usar els prefixos i **URIs correctes** (p. ex. SVG)?
* Document **ben format** abans de validar contra **DTD/XSD**?

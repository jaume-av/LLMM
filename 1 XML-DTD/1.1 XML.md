---

title:  XML: Definició, estructura i regles bàsiques
parent: 1.- XML i DTD
grand\_parent: Llenguatges de Marques
has\_children: true
layout: default
nav\_order: 10

---

# 1.- Què és XML?

XML, *Extensible Markup Language*, és un llenguatge de marques utilitzat per **emmagatzemar i intercanviar dades estructurades** de manera llegible tant per humans com per màquines.

### Principals característiques d’XML

* **És un llenguatge de marques**: utilitza etiquetes per definir i estructurar les dades.
* **És extensible**: permet definir etiquetes i estructures pròpies per adaptar-se a diferents aplicacions.
* **És jeràrquic**: segueix una estructura en forma d’arbre (arrel, pares, fills, germans).
* **Llegible per humans**: el format és clar i es pot editar manualment.
* **Interoperable**: és un estàndard àmpliament acceptat i entés per moltes aplicacions.
* **Usos variats**: configuració de programari, intercanvi de dades entre sistemes, serveis web, representació de documents XHTML, RSS/Atom, SVG, etc.
* **Compatibilitat amb Unicode**: pot usar UTF-8, UTF-16 i altres codificacions, permetent representar caràcters de quasi tots els idiomes.

**En resum**, XML és un llenguatge de marques versàtil i estandarditzat per representar i intercanviar dades estructurades de manera clara i flexible.

### XML NO és

* No és un llenguatge de programació.
* No és un protocol de xarxa.
* No és una base de dades.

  > XML pot emmagatzemar informació estructurada, però no és una BD en sentit estricte.

### Ecosistema i tecnologies relacionades

* **XPath** i **XQuery**: per seleccionar i consultar dades dins de documents XML.
* **XPointer** i **XLink**: per identificar parts concretes d’un document i afegir enllaços.
* **DTD** i **XML Schema (XSD)**: per definir l’estructura i validesa dels documents.
* **XSLT** i **XSL-FO**: per transformar documents XML a altres formats i aplicar estils.

---

## 2.- Anàlisi i validació d’XML

### 2.1 Què és un parser i per a què serveix?

Un **parser** (analitzador) és un programa o llibreria que **llegeix** un document XML i el **comprova** contra les regles del llenguatge. Després, el **converteix a una estructura** que el codi pot manipular (un arbre de nodes, esdeveniments de lectura, etc.).

Utilitats principals:

* **Comprovació de ben formació**: detecta errors de sintaxi (arrel única, tancaments, niat, atributs entre cometes…).
* **Validació**: pot comprovar l’XML contra un **DTD** o un **XSD** per assegurar l’estructura esperada.
* **Accés a dades**: exposa el contingut de l’XML al programa (per a llegir, transformar, importar a BD, etc.).

### 2.2 Tipus de parsers (visió pràctica)

* **DOM**: carrega **tot el document a memòria** i l’exposa com un **arbre** (fàcil de manipular; cost en memòria).
* **SAX**: processament **basat en esdeveniments** (seqüencial, molt eficient en memòria; més complex per modificar).
* **StAX** (pull parsing): semblant a SAX però el codi **controla** quan llegir el pròxim esdeveniment (equilibri entre DOM i SAX).

### 2.3 Nivells de comprovació

**Ben format (well-formed)**
Document que compleix les regles bàsiques d’XML.
Exemple correcte:

```xml
<article>Disquet</article>
```

Exemple incorrecte:

```xml
<article>Disquet
```

**Vàlid (valid)**
Document ben format que, a més, compleix l’estructura definida en un **DTD** o **XSD**.
Exemple: si l’esquema indica que `<persona>` ha de tindre `<nom>` i `<edat>`, un document sense `<edat>` és ben format però **no vàlid**.

### 2.4 Tractament d’errors

* **Errors de ben formació**: **fatals**; el parser ha d’aturar-se.
* **Errors de validesa**: el parser pot continuar, però el document es qualifica com a **invàlid**.

### 2.5 Analitzadors XML habituals

* **xmllint** (libxml2).
* **Apache Xerces** (Java, C++).
* **Expat** (C).

**Comandes bàsiques amb xmllint**:

```bash
xmllint --noout exemple.xml                 # comprova ben formació
xmllint --schema esquema.xsd exemple.xml    # comprova validesa
```

---

## 3.- Regles bàsiques d’XML

Un document XML està format per **text, etiquetes i atributs**.

Exemple:

```xml
<nom carrec="coordinadora">Isabel S.</nom>
```

* **Etiquetes**: `<nom>...</nom>`
* **Atributs**: `carrec="coordinadora"`
* **Text**: `Isabel S.`

### 3.1 Regles fonamentals

1. **Etiqueta arrel única**

Correcte:

```xml
<persona>
  <nom>Ana</nom>
</persona>
```

Incorrecte (dues arrels):

```xml
<persona><nom>Ana</nom></persona>
<nom>Lola</nom>
```

2. **Etiquetes tancades**

Correcte:

```xml
<article>Disquet</article>
```

Incorrecte:

```xml
<article nom="disquet">
```

Etiqueta buida:

```xml
<article nom="disquet"/>
```

3. **Etiquetes correctament niades**

Correcte:

```xml
<inventari>
  <article>Disquet</article>
</inventari>
```

Incorrecte:

```xml
<inventari>
  <article>Disquet</inventari>
</article>
```

4. **Noms d’elements i atributs**

* Han de començar per **lletra** o **\_**.
* Poden incloure **lletres, dígits, `-`, `_`, `.`** i **`:`** (este últim només quan es treballa amb **namespaces**).
* No poden contindre **espais**.
* No poden començar per **`xml`** (en qualsevol combinació de majúscules/minúscules).

Correctes:

```xml
<Ciutat></Ciutat>
<Item12></Item12>
<_Hola></_Hola>
```

Incorrectes:

```xml
<1Osset></1Osset>
<Aitor Tilla></Aitor Tilla>
<$Diners></$Diners>
```

5. **Distinció majúscules/minúscules**

```xml
<Article>Disquet</Article>
<article>Disquet</article>  <!-- elements diferents -->
```

6. **Atributs entre cometes i amb valor**

Correcte:

```xml
<Article quantitat="3">Disquet</Article>
```

Incorrectes:

```xml
<Article quantitat=3>Disquet</Article>
<Article quantitat>Disquet</Article>
```

---

### Exemple:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<persona>
  <nom>Ana</nom>
  <edat>20</edat>
</persona>
```

---

## 4.- Creació de documents XML

Aquesta secció recull elements freqüents d’un document XML i explica **per a què serveix cadascun** amb exemples pràctics.

### 4.1 Declaració XML

Línia **opcional però recomanable** al principi del fitxer. Indica versió, codificació de caràcters i si el document depén d’entitats externes.

```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
```

* **version**: habitualment `"1.0"`.
* **encoding**: codificació de caràcters (per defecte, UTF-8).
* **standalone**: `"yes"` si el document és autosuficient; `"no"` si depén, per exemple, d’un **DTD extern**.

Utilitat: garantir una interpretació correcta de caràcters (accents, símbols), interoperabilitat entre sistemes i claredat sobre dependències externes.

### 4.2 Atributs

Aporten **metadades o paràmetres** a un element en forma de parell `clau="valor"` i **sempre** entre cometes.

```xml
<persona nom="Lola" cognom="Mento" edat="30"/>
```

Quan usar atributs vs elements:

* **Atributs**: dades **curtes** i **identificadores** (id, tipus, idioma, referències).
* **Elements**: dades **estructurades o de contingut** (text llarg, subestructures).

Exemples d’atributs especials definits pel mateix XML:

* `xml:lang`: idioma del contingut.
* `xml:id`: identificador únic.
* `xml:base`: URL base per a rutes relatives.
* `xml:space`: control d’espais en blanc (`default`/`preserve`).

### 4.3 Entitats

Serveixen per escriure **caràcters reservats** o problemàtics dins del text.

| Entitat  | Caràcter | Ús típic                                       |
| -------- | -------- | ---------------------------------------------- |
| `&lt;`   | `<`      | Mostrar `<` en text sense iniciar una etiqueta |
| `&gt;`   | `>`      | Mostrar `>` en text                            |
| `&amp;`  | `&`      | En URLs amb paràmetres: `?q=1&amp;cat=2`       |
| `&quot;` | `"`      | Cometes dins d’un atribut                      |
| `&apos;` | `'`      | Apòstrof                                       |

Correcte:

```xml
<frase>5 &lt; 10 &amp; 3 &gt; 2</frase>
<url>https://exemple.com?q=1&amp;cat=2</url>
```

Incorrecte:

```xml
<frase>5 < 10</frase> <!-- el parser interpreta "< 10" com a marca -->
```

### 4.4 CDATA

Una secció **CDATA** indica al parser que **no ha d’interpretar** el contingut com a marques, sinó com a **text literal**. És útil per incrustar fragments amb `<`, `>`, `&` sense haver-los d’escapar.

```xml
<script>
  <![CDATA[
    if (5 < 10) {
      alert("Hola món");
    }
  ]]>
</script>
```

Limitacions: dins d’una CDATA **no** pot aparéixer la seqüència `]]>` i **no** es poden **niar**.

## 4.5 Comentaris

Informació per a persones lectores; els parsers els **ignoren**.

```xml
<!-- Aquest és un comentari -->
<persona>
  <nom>Ana</nom>
  <!-- <edat>20</edat>  comentat temporalment -->
</persona>
```

### 4.6 Instruccions de procés (Processing Instructions, PI)

Informen aplicacions de com **tractar** el document. Les més comunes associen **fulls d’estil** (CSS o XSLT).

Exemple amb **CSS**:

```xml
<?xml-stylesheet type="text/css" href="estilo-animales.css"?>
<animales>
  <animal>
    <nombre>Perro</nombre>
    <patas>4</patas>
  </animal>
</animales>
```

Fitxer `estilo-animales.css`:

```css
nombre { color: blue; font-size: 40px }
patas  { color: red;  font-size: 22px }
```

Un navegador compatible aplicarà l’estil als elements mostrant “nombre” en blau i “patas” en roig.

Exemple amb **XSLT**:

```xml
<?xml-stylesheet type="text/xsl" href="transformacio.xsl"?>
```

Això indica que el document es pot transformar a HTML (o altre format) usant l’estil XSLT indicat.

---

## 5.- Espais de noms (Namespaces)

Els **namespaces** eviten **conflictes de noms** quan es combinen dades de diferents vocabularis XML (mateix nom d’etiqueta, significats diferents). Es defineixen amb l’atribut **`xmlns`** i opcionalment un **prefix**.

### 5.1 Problema sense namespaces

```xml
<dades>
  <nom>Ana</nom>          <!-- alumna -->
  <nom>Professor X</nom>  <!-- professor -->
</dades>
```

No es pot distingir quin `<nom>` pertany a cada domini.

### 5.2 Solucions amb namespaces

**Amb espai de noms per defecte**:

```xml
<alumnes xmlns="http://www.exemple.com/alumnes">
  <nom>Ana</nom>
  <nom>Pere</nom>
</alumnes>
```

**Amb prefixos**:

```xml
<classe xmlns:A="http://server/alumnes"
        xmlns:P="http://server/professors">
  <A:nom>Ana</A:nom>
  <P:nom>Lola</P:nom>
</classe>
```

**Barreja (per defecte + prefix)**:

```xml
<classe xmlns="http://server/alumnes"
        xmlns:P="http://server/professors">
  <nom>Ana</nom>       <!-- alumna -->
  <P:nom>Lola</P:nom>  <!-- professora -->
</classe>
```

### 5.3 Bones pràctiques i errors comuns

* Declarar el **namespace abans** d’usar el prefix.
* No usar `:` si no es treballa amb namespaces.
* El **nom URI** identifica el vocabulari; no cal que siga descarregable.
* Error típic: **prefix no declarat**.

  ```xml
  <A:nom>Ana</A:nom>  <!-- ERROR si no hi ha xmlns:A -->
  ```

**Namespaces habituals**:

* XML → `http://www.w3.org/XML/1998/namespace`
* XSD → `http://www.w3.org/2001/XMLSchema`
* XSLT → `http://www.w3.org/1999/XSL/Transform`
* XHTML → `http://www.w3.org/1999/xhtml`
* SVG → `http://www.w3.org/2000/svg`

**Exemple d’integració XHTML + SVG**:

```xml
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:svg="http://www.w3.org/2000/svg">
  <head><title>Mostra</title></head>
  <body>
    <h1>Gràfic</h1>
    <svg:svg width="120" height="60">
      <svg:rect x="10" y="10" width="100" height="40"/>
    </svg:svg>
  </body>
</html>
```

---

## 6.- Errors típics en XML

**Dues etiquetes arrel**

```xml
<persona>Ana</persona>
<persona>Pere</persona>  <!-- ERROR -->
```

**Etiquetes mal niades**

```xml
<article><titol>Hola</article></titol>  <!-- ERROR -->
```

**Atributs sense cometes**

```xml
<article quantitat=3>Disquet</article>   <!-- ERROR -->
```

**Caràcters especials sense entitats**

```xml
<text>5 < 10</text>  <!-- ERROR -->
```

**Prefix de namespace sense declarar**

```xml
<A:nom>Ana</A:nom>   <!-- ERROR: falta xmlns:A -->
```

---

## 7.- Activitats ràpides

1. **És ben format?** Marca com a correctes o incorrectes i corregeix:

```xml
<article>Disquet</article>
<article>Disquet</Article>
<article quantitat=3>Disquet</article>
```

2. **Entitats**: escriu correctament en XML:

```
5 < 10 & "hola"
```

3. **CDATA**: inclou aquest HTML dins d’un element `<exemple>` usant CDATA:

```html
<p>Hola món</p>
```

4. **Namespaces**: combina dos elements `<nom>` (alumnes i professors) en un mateix document XML evitant conflictes amb namespaces.

5. **Validació amb eina**: crea un fitxer `alumne.xml` i comprova amb `xmllint` si està ben format:

```bash
xmllint --noout alumne.xml
```

---

### En resum...

* Una **única arrel**.
* **Etiquetes tancades** i **niades** correctament.
* **Atributs entre cometes** i amb **valor**.
* **Entitats** per a `<`, `>`, `&`, `"`, `'`.
* Prefixos de **namespace declarats** abans d’usar-los.
* Document **ben format** abans de validar contra DTD/XSD.

---

## Exemple

Ací tens **un únic document XML complet** que reuneix i il·lustra, amb **comentaris interns**, pràcticament tots els conceptes tractats: declaració, PIs, ben formació, elements/atributs, entitats, CDATA, comentaris, espais de noms (per defecte i amb prefixos), atributs `xml:*` útils, elements buits, i referència d’esquema amb `xsi:schemaLocation`.

```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?xml-stylesheet type="text/css" href="centre.css"?>
<!--
  Exemple didàctic "complet" d'un document XML ben format i autoexplicatiu.

  QUÈ MOSTRA:
  - Declaració XML amb UTF-8 i standalone="yes"
  - Instrucció de procés per aplicar CSS al document
  - Comentaris (com aquest) ignorats pel parser
  - Espai de noms per defecte (centre) i prefixats (alum, prof, xlink)
  - Validació potencial via xsi:schemaLocation
  - Atributs xml:* (xml:lang, xml:base, xml:id, xml:space)
  - Elements, atributs, elements buits, entitats, CDATA
  - Enllaços amb XLink

  NOTA: L’URI de namespace identifica el vocabulari; no cal que siga descarregable.
-->

<centreEducatiu
    xmlns="http://example.org/centre"                 <!-- espai de noms per defecte per a elements del centre -->
    xmlns:alum="http://example.org/alumnes"          <!-- prefix per a vocabulari d'alumnes -->
    xmlns:prof="http://example.org/professors"       <!-- prefix per a vocabulari de professors -->
    xmlns:xlink="http://www.w3.org/1999/xlink"       <!-- XLink per a enllaços -->
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
      http://example.org/centre      centre.xsd
      http://example.org/alumnes     alumnes.xsd
      http://example.org/professors  professors.xsd"
    xml:lang="ca"                                     <!-- idioma per defecte del contingut -->
    xml:base="https://centre.exemple.org/dades/"      <!-- base per a rutes relatives en enllaços -->
    xml:id="centre-VA-001">                           <!-- identificador únic al document -->

    <!-- Capçalera amb metadades bàsiques -->
    <meta>
        <nom>IES La Vall</nom>
        <codi>46012345</codi>
        <adreca>
            <via tipus="carrer">Sant Vicent, 12</via>
            <municipi>La Vall</municipi>
            <provincia>València</provincia>
            <cp>46500</cp>
            <pais>ES</pais>
        </adreca>
        <contacte>
            <telefon/> <!-- exemple d'element buit ben format -->
            <email tipus="secretaria">secretaria@centre.exemple.org</email>
            <!-- Entitats per a caràcters especials dins de text i atributs -->
            <web títol="Centre &quot;La Vall&quot;">https://centre.exemple.org</web>
        </contacte>
        <!-- xml:space per preservar espais en blanc (p.ex. bloc de notes) -->
        <notes xml:space="preserve">
            Línia 1 amb espais finals    
            Línia 2     amb    múltiples    espais
        </notes>
    </meta>

    <!-- Oferta formativa amb elements del NS per defecte -->
    <oferta>
        <cicle codi="DAW" nivell="Grau Superior">
            <titol>Desenvolupament d'Aplicacions Web</titol>
            <anyInici>2025</anyInici>
            <!-- Text amb entitats: mostrar < i & literalment -->
            <descripcio>Aprén a fer aplicacions web: HTML, CSS, JS, XML (&lt;dades&gt;), APIs, &amp; més.</descripcio>
        </cicle>
        <cicle codi="SMX" nivell="Grau Mitjà">
            <titol>Sistemes Microinformàtics i Xarxes</titol>
            <anyInici>2025</anyInici>
            <descripcio>Instal·lació, configuració i manteniment d'equips i xarxes.</descripcio>
        </cicle>
    </oferta>

    <!-- Exemple de CDATA: text literal amb <, > i & sense escapar -->
    <avisos>
        <avís id="A1">
            <![CDATA[
                <strong>AVÍS</strong>: Demà a les 9:00 hi ha manteniment.
                Si veus "Error & Timeout", torna a intentar-ho.
            ]]>
        </avís>
    </avisos>

    <!-- Barreja de vocabularis: alumnes i professors amb prefixos diferents -->
    <comunitat>
        <alum:alumnes>
            <alum:alumne alum:id="al-001" xml:lang="ca">
                <alum:nom>Ana</alum:nom>
                <alum:cognoms>Pérez García</alum:cognoms>
                <alum:grup any="2025">DAW1</alum:grup>
                <!-- Enllaç semàntic amb XLink; xml:base fa la ruta relativa -->
                <alum:fitxa xlink:href="alumnes/al-001.xml" xlink:title="Fitxa d'Ana"/>
                <!-- Exemple d'atribut amb apòstrof escapada si fera falta en text -->
                <alum:observacions>Preferència per projectes full-stack</alum:observacions>
            </alum:alumne>

            <alum:alumne alum:id="al-002" xml:lang="es">
                <alum:nom>Pedro</alum:nom>
                <alum:cognoms>López Díaz</alum:cognoms>
                <alum:grup any="2025">DAW1</alum:grup>
                <alum:fitxa xlink:href="alumnes/al-002.xml" xlink:title="Ficha de Pedro"/>
                <!-- Exemple d'ús d'entitats dins del text -->
                <alum:observacions>Interés per XML &amp; XSLT</alum:observacions>
            </alum:alumne>
        </alum:alumnes>

        <prof:professors>
            <prof:professor prof:id="pr-101">
                <prof:nom>Laura</prof:nom>
                <prof:cognoms>Martí Ferrer</prof:cognoms>
                <prof:departament>Informàtica</prof:departament>
                <prof:email>laura.marti@centre.exemple.org</prof:email>
                <prof:assignatures>
                    <prof:assignatura codi="LMARKUP">Llenguatges de Marques</prof:assignatura>
                    <prof:assignatura codi="DWES">Desenvolupament Web en Entorn Servidor</prof:assignatura>
                </prof:assignatures>
            </prof:professor>

            <prof:professor prof:id="pr-102">
                <prof:nom>Jordi</prof:nom>
                <prof:cognoms>Soler Vidal</prof:cognoms>
                <prof:departament>Informàtica</prof:departament>
                <prof:email>jordi.soler@centre.exemple.org</prof:email>
                <prof:assignatures>
                    <prof:assignatura codi="DWEC">Desenvolupament Web en Entorn Client</prof:assignatura>
                    <prof:assignatura codi="DIW">Disseny d'Interfícies Web</prof:assignatura>
                </prof:assignatures>
            </prof:professor>
        </prof:professors>
    </comunitat>

    <!-- Secció de documents amb diferents idiomes i xml:lang local -->
    <documents>
        <doc tipus="projecte" xml:id="doc-proj-001" xml:lang="ca">
            <titol>Projecte XML/JSON en DAW1</titol>
            <resum>Integració d'intercanvi de dades amb validació i transformacions.</resum>
            <!-- Enllaç amb XLink que aprofita xml:base definit a l'arrel -->
            <enllac xlink:href="docs/proj-001.html" xlink:title="Guia del projecte"/>
        </doc>
        <doc tipus="normativa" xml:id="doc-norm-ES" xml:lang="es">
            <titol>Normativa de Evaluación</titol>
            <resum>Criterios de evaluación y recuperación.</resum>
            <enllac xlink:href="docs/normativa-es.pdf" xlink:title="PDF normativa ES"/>
        </doc>
    </documents>

    <!-- Exemple de secció amb text preformatat preservant espais -->
    <aula xml:space="preserve">
        <plànol>
            { Porta }---[ Taules ]---{ Pissarra }
        </plànol>
    </aula>

    <!-- Comentari final: recordatori d’errors típics a evitar
         - Dues arrels: NO (este document té <centreEducatiu> com a arrel única)
         - Etiquetes mal niades: NO
         - Atributs sense cometes: NO
         - Caràcters especials sense entitats (&, <, > dins de text): NO
         - Prefix de namespace sense declarar: NO (tots declarats a l’arrel)
    -->
</centreEducatiu>
```

